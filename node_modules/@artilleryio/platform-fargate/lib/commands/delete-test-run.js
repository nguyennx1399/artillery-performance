/** @license
 * (c) 2021 Shoreditch Ops Ltd. All rights reserved.
 *
 * This file is part of Artillery Pro (https://artillery.io)
 *
 * NOTICE: All information contained herein is, and remains
 * the property of Shoreditch Ops Ltd. The intellectual and
 * technical concepts contained herein are proprietary to
 * Shoreditch Ops Ltd and are protected by copyright law.
 *
 * Modification and/or redistribution of this material is
 * strictly forbidden unless prior written permission is
 * obtained from Shoreditch Ops Ltd.
 *
 */

module.exports = { deleteTestRun: deleteTestRunCommand };

const { deleteTestRun } = require('../data-api/delete-test-run');
const setDefaultAWSCredentials = require('../utils/aws-set-default-credentials');
const { TestNotFoundError } = require('../errors');

async function deleteTestRunCommand(testId) {
  try {
    await setDefaultAWSCredentials();
    await deleteTestRun(testId);
    console.log(`Test run ${testId} successfully deleted`);
  } catch (err) {
    if (err instanceof TestNotFoundError) {
      console.log(err.message);
    } else {
      console.error('Something went wrong');
      console.log(err);
    }

    process.exit(1);
  }
}
